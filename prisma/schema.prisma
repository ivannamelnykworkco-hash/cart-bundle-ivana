// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema
// To add or update a model in prisma
// npm run prisma migrate dev -- --name add-YourTableName-table
//
generator client {
  provider = "prisma-client-js"
}

// Note that some adapters may set a maximum length for the String type by default, please ensure your strings are long
// enough when changing adapters.
// See https://www.prisma.io/docs/orm/reference/prisma-schema-reference#string for more information
datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Session {
  id            String    @id
  shop          String
  state         String
  isOnline      Boolean   @default(false)
  scope         String?
  expires       DateTime?
  accessToken   String
  userId        BigInt?
  firstName     String?
  lastName      String?
  email         String?
  accountOwner  Boolean   @default(false)
  locale        String?
  collaborator  Boolean?  @default(false)
  emailVerified Boolean?  @default(false)
}

model Bundle {
  id            String   @id @default(cuid())
  shop          String
  name          String
  type          String
  status        String   @default("draft")
  products      Json
  discountType  String
  discountValue Float
  stats         Json
  settings      Json
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  
  @@index([shop])
  @@index([status])
}

model Analytics {
  id              String   @id @default(cuid())
  shop            String   @unique
  thisMonthRevenue Float   @default(0)
  allTimeRevenue   Float   @default(0)
  lastResetDate    DateTime @default(now())
  updatedAt        DateTime @updatedAt
}

model BundleView {
  id        String   @id @default(cuid())
  bundleId  String
  shop      String
  visitorId String
  createdAt DateTime @default(now())
  
  @@index([bundleId])
  @@index([shop])
}

model BundlePurchase {
  id        String   @id @default(cuid())
  bundleId  String
  shop      String
  orderId   String
  revenue   Float
  createdAt DateTime @default(now())
  
  @@index([bundleId])
  @@index([shop])
}

model GeneralSetting {
  id String @id @default(cuid())
  bundleId String
  discountId String
  bundleName String
  discountName String
  blockTitle String
  visibility String
  markets    String
  excludedProducts  String
  excludedCollections String
  selectedProducts String
  selectedCollections String
  excludeB2B Boolean
  excludePOS Boolean
  startDateTime     String
  setEndDate  Boolean 
  endDateTime   String
  letCustomer Boolean
  showVariant Boolean
  hideTheme   Boolean
  colorSwatchArray   String
  imageSwatchArray   String
  swatchOption String
  swatchType String
  swatchSize    Int
  swatchShape   String
  setDefaultVariant   Json?
  showPrices  Boolean
  showBothPrices  Boolean
  unitLabel   String
  useProductCompare Boolean
  showPricesWithout Boolean
  showPriceRounding Boolean
  priceRounding     String
  updateTheme       Boolean
  priceSelect       String
  skipCart    Boolean
  showAlert Boolean
  showWhenStock     Int
  msgText       String
  msgColor      String
  createdAt     String
  updatedAt     String
}

model CountdownTimer {
  id    String @id @default(cuid())
  isCountdown   Boolean
  visibility String
  fixedDurationTime   Int
  endDateTime   String
  msgText       String
  msgAlignment  Int
  msgBold       Boolean
  msgItalic     Boolean
  msgSize     Int
  msgBgColor    String
  msgTextColor  String    
  createdAt String 
  updatedAt String
}

model GeneralStyle {
  id    String @id @default(cuid())
  bundleId            String
  cornerRadius        Int
  spacing             Int
  cardsBgColor        String
  selectedBgColor     String
  borderColor         String
  blockTitleColor     String
  barTitleColor       String
  barSubTitleColor    String
  barPriceColor       String
  barFullPriceColor   String
  barLabelBackColor   String
  barLabelTextColor   String
  barBadgebackColor   String
  barBadgeTextColor   String
  barUpsellBackColor  String
  barUpsellTextColor  String
  barUpsellSelectedBackColor  String
  barUpsellSelectedTextColor  String     
  barBlocktitle       Int
  barBlocktitleFontStyle    String
  bartitleSize        Int
  bartitleFontStyle   String
  subTitleSize        Int
  subTitleStyle       String
  labelSize           Int
  labelStyle          String
  upsellSize          Int
  upsellStyle         String
  unitLabelSize       Int
  unitLabelStyle      String
  createdAt           String
  updatedAt           String
}

model VolumeDiscount {
  id                  String @id @default(cuid())
  bundleId            String
  visibility          String
  layoutImageUrl      String
  layoutButtonText    String
  layoutColor         String
  productPhotoSize    Int
  showProductName     Boolean
  showPrice           Boolean
  customButtonSize    Int
  customTextSize      Int
  customOverlayColor  String
  customPriceColor    String
  customCompareAtPriceColor  String
  customTextColor       String
  customButtonColor     String
  customButtonTextColor String
  customHeadingText     String
  customMessageText     String
  customButtonText      String
  customPhotoSize       Int
  createdAt             String
  updatedAt             String
}

model StickyAdd {
  id                  String @id @default(cuid())
  bundleId            String
  contentTitleText    String
  contentButtonText   String
  styleBgColor        String
  styleTitleColor     String
  styleButtonColor    String
  styleButtonTextColor  String
  styleTitleFontSize    Int
  styleTitleFontStyle   String
  styleButtonFontSize   Int
  styleButtonFontStyle  String
  stylePhotoSize        Int
  stylePhotoCornerRadius    Int
  styleButtonPadding    Int
  styleButtonCornerRadius   Int
  createdAt             String
  updatedAt             String
}

model CheckboxUpsell {
  id                  String @id @default(cuid())
  bundleId            String
  upsellData          Json
  createdAt             String
  updatedAt             String
}

model QuantityBreak {
  id        String @id @default(cuid())
  bundleId  String
  isOpen    Boolean
  quantity  Int
  title     String     
  subtitle  String
  selectPrice           String 
  discountPrice         Float?
  badgeText             String
  badgeStyle            String
  labelText             String 
  isSelectedByDefault   Boolean
  isShowAsSoldOut       Boolean
  labelTitle            String
  opacity               Int
  bgColor               String
  textColor             String
  labelSize             Int
  upsellItems           QbUpsellItem[]  
  createdAt             String
  updatedAt             String
}

model BuyXGetY {
  id        String @id @default(cuid())
  bundleId  String
  isOpen    Boolean
  buyQuantity   Int
  getQuantity   Int
  title       String     
  subtitle    String
  badgeText   String
  badgeStyle  String
  labelText   String  
  isSelectedByDefault   Boolean
  isShowAsSoldOut       Boolean
  labelTitle      String
  opacity         Int
  bgColor         String
  textColor       String
  labelSize       Int
  upsellItems         BxGyUpsellItem[]    
  createdAt       String
  updatedAt       String
}

model BundleUpsell {
  id          String @id @default(cuid())
  bundleId    String
  isOpen      Boolean
  layoutOption    String
  title       String     
  subtitle    String
  badgeText   String
  badgeStyle  String
  defaultVariant          Json?
  labelText       String @default("")
  isSelectedByDefault     Boolean
  isShowQuantitySelector  Boolean
  productCounts           Int
  selectPrice             String
  discountPrice           Float?
  productItems            ProductItem[]   
  isShowAsSoldOut         Boolean
  labelTitle      String
  opacity         Int
  bgColor         String
  textColor       String
  labelSize       Int
  upsellItems         BundleUpsellItem[]  
  createdAt String
  updatedAt String
}

model QbUpsellItem {
  id          String @id @default(cuid())
  qbId        String
  isSelectedProduct   String
  selectedVariants    String
  selectedProduct     Json?
  quantity            Int 
  base                Decimal  @default(10.00)
  calc                Decimal  @default(20.00)
  selectPrice         String
  discountPrice       Float?
  priceText           String
  imageSize           Int     
  isSelectedByDefault Boolean
  isVisibleOnly       Boolean
  isShowAsSoldOut     Boolean
  labelTitle          String
  opacity             Float
  bgColor             String
  textColor           String
  labelSize           Int             
  quantityBreak       QuantityBreak?   @relation(fields: [qbId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  createdAt           String
  updatedAt           String
}

model BxGyUpsellItem {
  id          String @id @default(cuid())
  bxGyId      String
  isSelectedProduct   String
  selectedVariants    String
  selectedProduct     Json?
  quantity            Int 
  selectPrice         String
  discountPrice       Float?
  priceText           String
  imageSize           Int     
  isSelectedByDefault Boolean
  isVisibleOnly       Boolean
  isShowAsSoldOut     Boolean
  labelTitle          String
  opacity             Float
  bgColor             String
  textColor           String
  labelSize           Int             
  buyXGetY            BuyXGetY?        @relation(fields: [bxGyId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  createdAt           String
  updatedAt           String
}

model BundleUpsellItem {
  id          String @id @default(cuid())
  buId      String
  isSelectedProduct   String
  selectedVariants    String
  selectedProduct     Json?
  quantity            Int 
  selectPrice         String
  discountPrice       Float?
  priceText           String
  imageSize           Int     
  isSelectedByDefault Boolean
  isVisibleOnly       Boolean
  isShowAsSoldOut     Boolean
  labelTitle          String
  opacity             Float
  bgColor             String
  textColor           String
  labelSize           Int             
  bundleUpsell        BundleUpsell?        @relation(fields: [buId], references: [id], onDelete: Cascade, onUpdate: Cascade)
  createdAt           String
  updatedAt           String
}

model ProductItem {
  id          String @id @default(cuid())
  buId        String
  quantity    Int
  selectPrice     String
  discountPrice   Float?
  selectedVariants         String
  selectedProduct     Json?
  createdAt           String
  updatedAt           String
  bundleUpsell        BundleUpsell    @relation(fields: [buId], references: [id], onDelete: Cascade, onUpdate: Cascade)
}

